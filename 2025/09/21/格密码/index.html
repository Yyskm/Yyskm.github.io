<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>格密码 | yskm</title><meta name="author" content="yskm"><meta name="copyright" content="yskm"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="格密码 作为后量子密码，可以用来抵抗量子攻击 向量 带有方向的线段 $\vec{u}&#x3D;(1,2)$  向量的运算 向量的运算满足平行四边形法则 $\vec{u}+\vec{v} &#x3D; \vec{w}$  $k\vec{u}&#x3D;(k,2k)$,也就是将长度扩大k倍($k \in \mathbb{Z}$)  向量空间 向量的集合，运算的空间 $\text { 1. } a \in V, b \in V \">
<meta property="og:type" content="article">
<meta property="og:title" content="格密码">
<meta property="og:url" content="http://example.com/2025/09/21/%E6%A0%BC%E5%AF%86%E7%A0%81/index.html">
<meta property="og:site_name" content="yskm">
<meta property="og:description" content="格密码 作为后量子密码，可以用来抵抗量子攻击 向量 带有方向的线段 $\vec{u}&#x3D;(1,2)$  向量的运算 向量的运算满足平行四边形法则 $\vec{u}+\vec{v} &#x3D; \vec{w}$  $k\vec{u}&#x3D;(k,2k)$,也就是将长度扩大k倍($k \in \mathbb{Z}$)  向量空间 向量的集合，运算的空间 $\text { 1. } a \in V, b \in V \">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/1.jpg">
<meta property="article:published_time" content="2025-09-21T06:59:21.980Z">
<meta property="article:modified_time" content="2025-09-22T11:32:04.041Z">
<meta property="article:author" content="yskm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/1.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "格密码",
  "url": "http://example.com/2025/09/21/%E6%A0%BC%E5%AF%86%E7%A0%81/",
  "image": "http://example.com/img/1.jpg",
  "datePublished": "2025-09-21T06:59:21.980Z",
  "dateModified": "2025-09-22T11:32:04.041Z",
  "author": [
    {
      "@type": "Person",
      "name": "yskm",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/09/21/%E6%A0%BC%E5%AF%86%E7%A0%81/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '格密码',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/transpancy.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/preview.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">yskm</span></a><a class="nav-page-title" href="/"><span class="site-name">格密码</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">格密码</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-09-21T06:59:21.980Z" title="发表于 2025-09-21 14:59:21">2025-09-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-22T11:32:04.041Z" title="更新于 2025-09-22 19:32:04">2025-09-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Learn/">Learn</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1>格密码</h1>
<p>作为后量子密码，可以用来抵抗量子攻击</p>
<h3 id="向量">向量</h3>
<p><code>带有方向的线段</code></p>
<p>$\vec{u}=(1,2)$</p>
<p><img src="/img/test_photo/40e2ef873d3289e328802cd1da2bbb83.png" alt=""></p>
<h4 id="向量的运算">向量的运算</h4>
<p>向量的运算满足平行四边形法则</p>
<p>$\vec{u}+\vec{v} = \vec{w}$</p>
<p><img src="/img/test_photo/bb60a7cf744ef3c090c814dd2079a880.png" alt=""></p>
<p>$k\vec{u}=(k,2k)$,也就是将长度扩大k倍($k \in \mathbb{Z}$)</p>
<p><img src="/img/test_photo/e813b965ea74b2524f51e9f498161042.png" alt=""></p>
<h3 id="向量空间">向量空间</h3>
<p>向量的集合，运算的空间<br>
$\text { 1. } a \in V, b \in V \text {, 则 } a+b \in V \$<br>
$\text { 2. } a \in V, k \in \mathbb{R} \text {, 则 } k a \in V \text { 。 }$</p>
<p>也就是满足封闭性</p>
<h3 id="向量正交与施密特-Schmidt-正交化">向量正交与施密特(Schmidt)正交化</h3>
<p>当 $ a \neq 0, b \neq 0 $ 时，当 ((a, b) = 0)，即 ( a^T b = 0 ) 时，称向量 ( a, b ) 正交。</p>
<p>由两两正交的非零向量组成的向量组称为正交向量组，由单位向量组成的正交向量组称为标准正交向量组。</p>
<p>( n ) 维欧氏空间求解正交基，一组基底为 $( \alpha_1, \alpha_2, \cdots, \alpha_n )$</p>
<p><strong>Step 1:</strong> 令 $\beta_1 = \alpha_1$</p>
<p><strong>Step 2:</strong> 计算 $\alpha_2$ 在 $\beta_1$ 方向上的投影，并做差得到<br>
$$<br>
\beta_2 = \alpha_2 - \frac{( \beta_1, \alpha_2 )}{( \beta_1, \beta_1 )} \beta_1<br>
$$<br>
<strong>Step 3:</strong> 计算 $\alpha_3$ 在向量 $\beta_1, \beta_2$ 方向的投影，继续做差得到 $\beta_3$</p>
<h3 id="格">格</h3>
<p>系数为整数的向量空间，完整定义：<em>m</em>维欧式空间$R^{m}$的n(m≥n)个线性无关向量$\vec{v_i}$的所有整系数的线性组合</p>
<p>$$<br>
L(V) = \left{ \sum_{i=1}^{n} k_i \mathbf{v}_i \ \middle| \ k_i \in \mathbb{Z}, 1 \leq i \leq n \right}<br>
$$<br>
其实格就是系数k必须是整数的向量空间</p>
<p><img src="/img/test_photo/d2acf1c6ee8179dd547e0ebaeddef661.png" alt=""></p>
<p>这上面的就是一个格，可以表示为<br>
$$<br>
L =\begin{bmatrix}<br>
0 &amp; 1\<br>
1 &amp; 0<br>
\end{bmatrix}<br>
$$<br>
这里每一个整数点都是格点，由所有的格点组成了格</p>
<h3 id="Hermite定理">Hermite定理</h3>
<p>这个定理给出了最短向量的上界</p>
<p><strong>对于n维的格L，都有一个非零向量v属于L，满足</strong><br>
$$<br>
| \mathbf{v} | \leq \sqrt{n} \cdot \det(L)^{\frac{1}{n}}<br>
$$<br>
<img src="/img/test_photo/a01f51375835c4aa4943325a1ea87d4a.png" alt=""></p>
<p>解释一下||v||表示格基的数量积，n为维度，det(L)为格L(矩阵)的行列式</p>
<p>这里公式的证明过程就不再赘述了，感兴趣的师傅可以去<a target="_blank" rel="noopener" href="https://www.ruanx.net/lattice-5/">这里</a>看看</p>
<h4 id="格基规约">格基规约</h4>
<p>这里就是为了找到最接近正交基的基向量</p>
<p>这里有个对Hermite定理的拓展，Hermite定理讨论的是最短向量的上界，这里对于一组基而言也有定理给出了上界<br>
$$<br>
|v_1||v_2|\cdots|v_n|\leq n^{n/2}\det(L)<br>
$$<br>
同时还有Hadamard不等式给出了下界<br>
$$<br>
|v_1||v_2|\cdots|v_n|\geq \det(L)<br>
$$<br>
们引入Hadamard比率，定义为<br>
$$<br>
{\cal H}({\cal B}) = \left(\frac{\det(L)}{|v_1||v_2|\cdots|v_n|}\right)^{1/n}<br>
$$<br>
当${\cal H}({\cal B})$越接近1，则这组基向量越接近正交基</p>
<p><img src="/img/test_photo/73168d1fd41ce9307a673c04df4eb0af.png" alt=""></p>
<p>利用LLL算法来找到这组基</p>
<h3 id="格密码的应用">格密码的应用</h3>
<h4 id="1-NTRU">1.NTRU</h4>
<p>模：p</p>
<p>私钥：(f,g)</p>
<p>公钥：$h = f^{-1} g \bmod p$</p>
<p>临时密钥：r</p>
<p>加密：<br>
$$<br>
c \equiv rh+m\equiv rf^{-1}g +m \pmod{p}<br>
$$<br>
解密：<br>
$$<br>
fc \equiv rg+fm \equiv fm \pmod{p}<br>
$$<br>
再乘上$f^{-1}$即可得到m</p>
<p>这里构造格<br>
$$<br>
L =\begin{bmatrix}<br>
1  &amp;h \<br>
0 &amp;p<br>
\end{bmatrix}<br>
$$<br>
我们还知道$hf+kp=g$</p>
<p>那么我们可以发现（f,g）是格点<br>
$$<br>
(f,k)L = (f,fh+pk) = (f,g)<br>
$$<br>
则如果我们能够找到(f,k)则可以得到(f,g)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line"> </span><br><span class="line">f = getPrime(<span class="number">400</span>)</span><br><span class="line">g = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">400</span>)</span><br><span class="line"> </span><br><span class="line">h = inverse(f, p) * g % p</span><br><span class="line"> </span><br><span class="line">m = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line">m = bytes_to_long(m)</span><br><span class="line"> </span><br><span class="line">c = (r*h + m) % p</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;h = <span class="subst">&#123;h&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 170990541130074930801165526479429022133700799973347532191727614846803741888876816210632483231997413973919037199883422312436314365293577997262903161076615619596783971730864586404602951191341733308807254112018161897113881363794353050758324742415299277578203838160939521046655099610387485947145087271531951477031</span></span><br><span class="line"><span class="string">h = 19027613518333504891337723135627869008620752060390603647368919831595397216728378486716291001290575802095059192000315493444659485043387076261350378464749849058547797538347059869865169867814094180939070464336693973680444770599657132264558273692580535803622882040948521678860110391309880528478220088107038861065</span></span><br><span class="line"><span class="string">c = 75639016590286995205676932417759002029770539425113355588948888258962338419567264292295302442895077764630601149285564849867773180066274580635377957966186472159256462169691456995594496690536094824570820527164224000505303071962872595619159691416247971024761571538057932032549611221598273371855762399417419551483</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>题目给出的条件是<br>
$$<br>
h \equiv f^{-1}g \pmod{p}<br>
$$</p>
<p>$$<br>
c \equiv rf^{-1}g+m \pmod{p}<br>
$$</p>
<p>$$<br>
fc \equiv rg+fm \pmod{p}<br>
$$</p>
<p>$$<br>
fc-rg \equiv fm \pmod{p}<br>
$$</p>
<p>两边同时模g<br>
$$<br>
fm \equiv (fc \bmod p) \bmod g<br>
$$</p>
<p>$$<br>
m \equiv (fc \bmod p)f^{-1} \bmod g<br>
$$</p>
<p>显然当rg+fm&lt;p,m&lt;rg*+<em>fm</em>&lt;<em>p</em>,<em>m</em>&lt;*g时才能正确解密</p>
<p>所以<br>
$$<br>
\begin{pmatrix}<br>
{f} &amp;-k<br>
\end{pmatrix}\begin{bmatrix}<br>
1  &amp;h \<br>
0 &amp;p<br>
\end{bmatrix}=\begin{pmatrix}<br>
{f} &amp; g<br>
\end{pmatrix}<br>
$$<br>
这里判断是否满足Hermite定理,如果满足则可以直接求出最短的向量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)  </span><br><span class="line"></span><br><span class="line">f = flag = getPrime(<span class="number">400</span>)  </span><br><span class="line"></span><br><span class="line">g = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f.bit_length())  </span><br><span class="line"></span><br><span class="line">temp = gmpy2.iroot(<span class="number">2</span>  * p, <span class="number">2</span>)[<span class="number">0</span>]  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp.bit_length()) </span><br><span class="line"></span><br><span class="line">temp2 = gmpy2.iroot(f**<span class="number">2</span>+(g)**<span class="number">2</span>, <span class="number">2</span>)[<span class="number">0</span>]  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp2.bit_length())  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> temp.bit_length() &gt;= temp2.bit_length():</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;true&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;false&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>这里显然是满足的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">170990541130074930801165526479429022133700799973347532191727614846803741888876816210632483231997413973919037199883422312436314365293577997262903161076615619596783971730864586404602951191341733308807254112018161897113881363794353050758324742415299277578203838160939521046655099610387485947145087271531951477031</span></span><br><span class="line">h = <span class="number">19027613518333504891337723135627869008620752060390603647368919831595397216728378486716291001290575802095059192000315493444659485043387076261350378464749849058547797538347059869865169867814094180939070464336693973680444770599657132264558273692580535803622882040948521678860110391309880528478220088107038861065</span></span><br><span class="line">c = <span class="number">75639016590286995205676932417759002029770539425113355588948888258962338419567264292295302442895077764630601149285564849867773180066274580635377957966186472159256462169691456995594496690536094824570820527164224000505303071962872595619159691416247971024761571538057932032549611221598273371855762399417419551483</span></span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,[[h,<span class="number">1</span>],[p,<span class="number">0</span>]])</span><br><span class="line"><span class="built_in">print</span>(L.LLL())</span><br><span class="line">g,f = L.LLL()[<span class="number">0</span>]</span><br><span class="line">g,f = <span class="built_in">abs</span>(g),<span class="built_in">abs</span>(f)</span><br><span class="line"></span><br><span class="line">m = ((f*c%p)*gmpy2.invert(f,g)) % g</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">g = getPrime(<span class="number">128</span>)</span><br><span class="line">h = gmpy2.invert(f+<span class="number">20192020202120222023</span>, p) * g % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">h = 2230300126583677861466927910427460605336142000604400796769019169330805327830058127399640469637301157563524664730082687590109425103649095203274991089542329</span></span><br><span class="line"><span class="string">p = 6950733137747588463708927295050453925761832477377823596882238234496472403054344156839969133381577140118982692621000380716326275220824006196311323447685281</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>这里可以看到<code>f</code>就是我们要求的flag<br>
$$<br>
h \equiv (f+20192020202120222023)^{-1}g \pmod{p}<br>
$$<br>
这里我们不妨令${f}’  =f+20192020202120222023$<br>
$$<br>
h \equiv ({f}’ )^{-1}g \pmod{p}<br>
$$</p>
<p>$$<br>
h{f}'\equiv g \pmod{p}<br>
$$</p>
<p>$$<br>
g = h{f}’ -kp<br>
$$</p>
<p>那么现在我们就可以构造出格<br>
$$<br>
\begin{pmatrix}<br>
{f}’ &amp;k<br>
\end{pmatrix}\begin{bmatrix}<br>
1  &amp;h \<br>
0 &amp;p<br>
\end{bmatrix}=\begin{pmatrix}<br>
{f}’ &amp; g<br>
\end{pmatrix}<br>
$$<br>
这里的向量$\begin{pmatrix}{f}’ &amp; g\end{pmatrix}$就是我们的最短向量</p>
<p>我们通过LLL算法，将这组基向量(1,h),(0,p)变成正交化程度最大的基，$\begin{pmatrix}{f}’ &amp; g\end{pmatrix}$则是最短的向量</p>
<p>Hermite定理给出了这是最短向量的证明<br>
$$<br>
| \mathbf{v} | \leq \sqrt{n} \cdot \det(L)^{\frac{1}{n}}<br>
$$<br>
在本题中<br>
$$<br>
| \mathbf{\overrightarrow{v} } | \leq \sqrt{2} \cdot \det(p)^{\frac{1}{2}}<br>
$$<br>
这里向量v的范数<br>
$$<br>
\sqrt{f’^{2}+g^2}<br>
$$<br>
现在就看能不能满足下式了<br>
$$<br>
\sqrt{f’ ^{2} + g^{2}} \leq \sqrt{2p}<br>
$$<br>
题目给出了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = getPrime(512)</span><br><span class="line">g = getPrime(128)</span><br></pre></td></tr></table></figure>
<p>这里我们知道flag的长度一般都是40~45左右也就是255bit左右</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="number">2</span>**<span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;Do_you_like_Lattice?Addoil&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">f = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f.bit_length())  <span class="comment"># 255</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">g = getPrime(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">g = g</span><br><span class="line"></span><br><span class="line">temp = gmpy2.iroot(<span class="number">2</span> * p, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp.bit_length()) <span class="comment"># 257</span></span><br><span class="line"></span><br><span class="line">f = f + <span class="number">20192020202120222023</span>  </span><br><span class="line"></span><br><span class="line">temp2 = gmpy2.iroot(f**<span class="number">2</span>+(b*g)**<span class="number">2</span>, <span class="number">2</span>)[<span class="number">0</span>]  </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp2.bit_length())  </span><br></pre></td></tr></table></figure>
<p>这里是满足该定理的，所以我们不需要配平可以直接求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">h = <span class="number">2230300126583677861466927910427460605336142000604400796769019169330805327830058127399640469637301157563524664730082687590109425103649095203274991089542329</span></span><br><span class="line">p = <span class="number">6950733137747588463708927295050453925761832477377823596882238234496472403054344156839969133381577140118982692621000380716326275220824006196311323447685281</span></span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[<span class="number">1</span>,h],[<span class="number">0</span>,p]])</span><br><span class="line"><span class="built_in">print</span>(Ge.LLL())</span><br><span class="line">f,g = Ge.LLL()[<span class="number">0</span>]</span><br><span class="line">f,g = <span class="built_in">abs</span>(f),<span class="built_in">abs</span>(g)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(f-<span class="number">20192020202120222023</span>)))</span><br></pre></td></tr></table></figure>
<h5 id="easyLattice">easyLattice</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">47</span></span><br><span class="line"></span><br><span class="line">f = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">g = getPrime(<span class="number">128</span>)</span><br><span class="line">h = gmpy2.invert(f, p) * g % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">h = 9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span></span><br><span class="line"><span class="string">p = 11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947     </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>同样的我们先列出加密等式<br>
$$<br>
h \equiv f^{-1}g \pmod{p}<br>
$$</p>
<p>$$<br>
hf = g+kp<br>
$$</p>
<p>$$<br>
g=hf-kp<br>
$$</p>
<p>我们可以列出格<br>
$$<br>
\begin{pmatrix}<br>
{f} &amp;k<br>
\end{pmatrix}\begin{bmatrix}<br>
1  &amp;h \<br>
0 &amp;p<br>
\end{bmatrix}=\begin{pmatrix}<br>
{f} &amp; g<br>
\end{pmatrix}<br>
$$<br>
接下来要判断是否满足Hermite定理</p>
<p>那么按照题目给出的条件，我们知道p是512bit，g是128bit，flag的长度是47<br>
$$<br>
\sqrt{(f’)^{2}+g^2} \leq \sqrt{2p}<br>
$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;6102e15e-a82d-46aa-bdb4-9e82679710f243433&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line"></span><br><span class="line">f = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f.bit_length()) </span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">g = getPrime(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">temp = gmpy2.iroot(<span class="number">2</span> * p, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp.bit_length()) <span class="comment"># 257</span></span><br><span class="line"></span><br><span class="line">temp2 = gmpy2.iroot(f**<span class="number">2</span>+g**<span class="number">2</span>,<span class="number">2</span>)[<span class="number">0</span>] </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp2.bit_length())  <span class="comment">#375</span></span><br></pre></td></tr></table></figure>
<p>这里显然是不满足Hermite定理的，所以我们需要配平</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="number">2</span>**<span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;6102e15e-a82d-46aa-bdb4-9e82679710f243433&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line"></span><br><span class="line">f = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f.bit_length()) </span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">g = getPrime(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">g =g</span><br><span class="line"></span><br><span class="line">temp = gmpy2.iroot(<span class="number">2</span> * p * b, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp.bit_length()) <span class="comment"># 385</span></span><br><span class="line"></span><br><span class="line">temp2 = gmpy2.iroot(f**<span class="number">2</span>+(g)**<span class="number">2</span>,<span class="number">2</span>)[<span class="number">0</span>] </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp2.bit_length())  <span class="comment">#375</span></span><br></pre></td></tr></table></figure>
<p>配平后就满足了Hermite定理，也就是存在最短向量，此时的格变为<br>
$$<br>
\begin{bmatrix}<br>
1  &amp;h *b \<br>
0 &amp;p * b<br>
\end{bmatrix}<br>
$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">h = <span class="number">9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span></span><br><span class="line">p = <span class="number">11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947</span>  </span><br><span class="line">b = <span class="number">2</span>**<span class="number">256</span></span><br><span class="line">Ge = Matrix(ZZ,[[<span class="number">1</span>,h * b ],[<span class="number">0</span>,p * b]])</span><br><span class="line"><span class="built_in">print</span>(Ge.LLL())</span><br><span class="line">f,g = Ge.LLL()[<span class="number">0</span>]</span><br><span class="line">f,g = <span class="built_in">abs</span>(f),<span class="built_in">abs</span>(g)</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(f))</span><br></pre></td></tr></table></figure>
<p>对于格来说最短向量的界限是比较模糊的，有时候可能出现满足Hermite定理但就是求不出最短向量，这个时候可以考虑高斯启发式</p>
<p>高斯启发式是对Hermite定理的进一步缩小，假设L是n维格，高斯所期望的最短的长度是<br>
$$<br>
\sigma(L) = \sqrt{\tfrac{n}{2\pi e}} (Det(L))^{\tfrac{1}{n}}<br>
$$<br>
高斯启发式表示，在一个“随机选择的格”中的最短非零向量满足<br>
$$<br>
|\vec{v}_{\text{shortest}}| \approx \sigma(L)<br>
$$</p>
<h4 id="2-背包密码">2.背包密码</h4>
<p>参数</p>
<p>私钥为一个超递增数列{$a_{n}$},满足<br>
$$<br>
a_i\sum_{k=1}^{i-1} a_k<br>
$$<br>
模数m，满足<br>
$$<br>
m&gt;\sum_{i=1}^{n}a_i<br>
$$<br>
乘数w,满足gcd⁡(w,m)=1</p>
<p>公钥{$b_i$},满足<br>
$$<br>
b_i \equiv wa_i \pmod{m}<br>
$$<br>
加密</p>
<p>设明文为{$v_i$},$v_i \in {(0,1)}$<br>
$$<br>
c = \sum_{i=1}^{n}b_iv_i \pmod(m)<br>
$$<br>
解密<br>
$$<br>
v = w^{-1}c \equiv \sum_{i=1}^n v_i a_i \pmod{m}<br>
$$<br>
构造格<br>
$$<br>
L =<br>
\begin{bmatrix}<br>
1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; b_1 \<br>
0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 &amp; b_2 \<br>
0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 &amp; b_3 \<br>
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \<br>
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 &amp; b_n \<br>
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; -c<br>
\end{bmatrix}<br>
$$<br>
这里的格点是v=(v1,v2,v3,…,vn,1)<br>
$$<br>
(v_1, v_2, \cdots, v_n, 1) \times L = (v_1, v_2, \cdots, v_n, 0)<br>
$$<br>
同样有<br>
$$<br>
|v| = \sqrt{\sum v_i^2} &lt; \sqrt{n}<br>
$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(<span class="string">b&#x27;******&#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">bin</span>(flag)[<span class="number">2</span>:]  <span class="comment">#将flag转为二进制</span></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(flag)</span><br><span class="line"></span><br><span class="line">a = [random.randint(<span class="number">1</span>, <span class="number">4</span>**n)]   <span class="comment">#生成的是超递增序列</span></span><br><span class="line"></span><br><span class="line">s = a[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line"></span><br><span class="line">  a.append(random.randint(s+<span class="number">1</span>, <span class="number">4</span>**(n+i)))</span><br><span class="line"></span><br><span class="line">  s += a[i]</span><br><span class="line"></span><br><span class="line">m = random.randint(a[-<span class="number">1</span>] + <span class="number">1</span>, <span class="number">2</span>*a[-<span class="number">1</span>])  <span class="comment">#生成m大于超递增序列</span></span><br><span class="line"></span><br><span class="line">w = random.randint(<span class="number">1</span>, m)   <span class="comment">#生成乘数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> gcd(w, m) == <span class="number">1</span>   <span class="comment">#保证了互质</span></span><br><span class="line"></span><br><span class="line">b = [w*i % m <span class="keyword">for</span> i <span class="keyword">in</span> a]    <span class="comment">#生成私钥和公钥</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line"></span><br><span class="line">  c = (c + b[i]*<span class="built_in">int</span>(flag[i]))    <span class="comment">#加密</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output&#x27;</span>, <span class="string">&#x27;w+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>, file=f)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>, file=f)</span><br></pre></td></tr></table></figure>
<p>这里就是非常标准的背包密码了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">b = [...]</span><br><span class="line">c = ...</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(b)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line">L = Matrix(ZZ, n+<span class="number">1</span>, n+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    L[i,i] = <span class="number">1</span></span><br><span class="line">    L[i,-<span class="number">1</span>] = b[i]</span><br><span class="line">L[-<span class="number">1</span>,-<span class="number">1</span>] = -c</span><br><span class="line"></span><br><span class="line">res = L.LLL()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>):</span><br><span class="line">    M = res.row(i).<span class="built_in">list</span>()</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">        <span class="keyword">if</span> m != <span class="number">0</span> <span class="keyword">and</span> m != <span class="number">1</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(i, M)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag =  [1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># flag = int(&#x27;&#x27;.join(list(map(str, flag))), 2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(long_to_bytes(flag))</span></span><br></pre></td></tr></table></figure>
<h4 id="题目">题目</h4>
<h5 id="p3">p3</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">a = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">b = getPrime(<span class="number">1536</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">r = random.randint(<span class="number">2</span>**<span class="number">14</span>, <span class="number">2</span>**<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> ((p-r) * a + q) % b &lt; <span class="number">50</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">65537</span>, p*q)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c = 78168998533427639204842155877581577797354503479929547596593341570371249960925614073689003464816147666662937166442652068942931518685068382940712171137636333670133426565340852055387100597883633466292241406019919037053324433086548680586265243208526469135810446004349904985765547633536396188822210185259239807712</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a = 134812492661960841508904741709490501744478747431860442812349873283670029478557996515894514952323891966807395438595833662645026902457124893765483848187664404810892289353889878515048084718565523356944401254704006179297186883488636493997227870769852726117603572452948662628907410024781493099700499334357552050587</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">b = 1522865915656883867403482317171460381324798227298365523650851184567802496240011768078593938858595296724393891397782658816647243489780661999411811900439319821784266117539188498407648397194849631941074737391852399318951669593881907935220986282638388656503090963153968254244131928887025800088609341714974103921219202972691321661198135553928411002184780139571149772037283749086504201758438589417378336940732926352806256093865255824803202598635567105242590697162972609</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>和上面的题目相似，这里变成了解RSA，那么我们就需要求出p，q，对于p,q给出了一个关系式，那么我们就可以用格来求出p，q</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r = random.randint(<span class="number">2</span>**<span class="number">14</span>, <span class="number">2</span>**<span class="number">15</span>)</span><br><span class="line">((p-r) * a + q) % b &lt; <span class="number">50</span></span><br></pre></td></tr></table></figure>
<p>这里可以发现<code>r</code>和关系式并没有给出大小，但是给出了范围，这里显然是可以用爆破来解决的因为都不是很大</p>
<p>这里我们不妨碍令<code>x = ((p-r) * a + q) % b</code>,$p’=(p-r)$那么就有<br>
$$<br>
x = ({p}'*a+q)+kb<br>
$$</p>
<p>$$<br>
x - kb = {p}'*a+q<br>
$$</p>
<p>那么我们可以造格<br>
$$<br>
L = \begin{bmatrix}<br>
1 &amp; a\<br>
0 &amp; b<br>
\end{bmatrix}<br>
$$<br>
那么就有<br>
$$<br>
\begin{pmatrix}<br>
{p}’ &amp; k<br>
\end{pmatrix}\begin{bmatrix}<br>
1 &amp; a\<br>
0 &amp; b<br>
\end{bmatrix}=\begin{pmatrix}<br>
{p}’ &amp; x-q<br>
\end{pmatrix}<br>
$$<br>
还是要先判断是否满足Hermite定理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">b = getPrime(<span class="number">1536</span>)  </span><br><span class="line"></span><br><span class="line">f = flag = getPrime(<span class="number">225</span>)  </span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">r = getPrime(<span class="number">2</span>**<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f.bit_length())  </span><br><span class="line"></span><br><span class="line">temp = gmpy2.iroot(<span class="number">2</span>  * b, <span class="number">2</span>)[<span class="number">0</span>]  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp.bit_length()) </span><br><span class="line"></span><br><span class="line">temp2 = gmpy2.iroot((p-r)**<span class="number">2</span>+(<span class="number">50</span>-q)**<span class="number">2</span>, <span class="number">2</span>)[<span class="number">0</span>]  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp2.bit_length())  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> temp.bit_length() &gt;= temp2.bit_length():</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;true&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;false&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#513</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#512</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#true</span></span><br></pre></td></tr></table></figure>
<p>这里是满足的，那么就直接LLL规约了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">a = </span><br><span class="line"></span><br><span class="line">b = </span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,[[<span class="number">1</span>,a ],[<span class="number">0</span>, b]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(L.LLL())</span><br><span class="line"></span><br><span class="line">f,g = L.LLL()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">f,g = <span class="built_in">abs</span>(f),<span class="built_in">abs</span>(g)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"><span class="comment">#11296178014269303494837745604378279247866909144617752153545368028888626096702713262852534563523632474606208277782361536096982136624743993713145172222722488</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里我们就求出了<code>(p-r)</code>和<code>(x-q)</code>的值，后面爆破<code>r</code>和<code>x</code>即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">e=</span><br><span class="line"></span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">p_r=</span><br><span class="line"></span><br><span class="line">q_x=</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">14</span>,<span class="number">2</span>**<span class="number">15</span>):</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line"></span><br><span class="line">    p = p_r + r</span><br><span class="line"></span><br><span class="line">    q = q_x + x</span><br><span class="line"></span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> gmpy2.gcd(phi, <span class="number">65537</span>) != <span class="number">1</span>:</span><br><span class="line"></span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    m = <span class="built_in">pow</span>(c, gmpy2.invert(<span class="number">65537</span>, phi), p * q)</span><br><span class="line"></span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&quot;NSSCTF&quot;</span> <span class="keyword">in</span> flag :</span><br><span class="line"></span><br><span class="line">      <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line"><span class="comment">#NSSCTF&#123;0fc9dee6-ebfb-40bd-b800-b3ebe440be70&#125;</span></span><br></pre></td></tr></table></figure>
<h5 id="P4">P4</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">r = getPrime(<span class="number">175</span>)</span><br><span class="line"></span><br><span class="line">a = inverse(r, p)</span><br><span class="line"></span><br><span class="line">a = (a*flag) % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a = </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">p = </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>还是先列出等式<br>
$$<br>
a = r^{-1}*flag +kp<br>
$$</p>
<p>$$<br>
flag = r*a+kp<br>
$$</p>
<p>构造格<br>
$$<br>
L = \begin{bmatrix}<br>
1 &amp; a\<br>
0 &amp; p<br>
\end{bmatrix}<br>
$$</p>
<p>$$<br>
\begin{pmatrix}<br>
r &amp; k<br>
\end{pmatrix}\begin{bmatrix}<br>
1 &amp; a\<br>
0 &amp; p<br>
\end{bmatrix}=\begin{pmatrix}<br>
r &amp; flag<br>
\end{pmatrix}<br>
$$</p>
<p>还是先判断是否满足Hermite定理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#python</span><br><span class="line"></span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">p = getPrime(1024) </span><br><span class="line"></span><br><span class="line">f = flag = getPrime(225)  </span><br><span class="line"></span><br><span class="line">r = getPrime(175)</span><br><span class="line"></span><br><span class="line">print(f.bit_length())  </span><br><span class="line"></span><br><span class="line">temp = gmpy2.iroot(2  * p, 2)[0]  </span><br><span class="line"></span><br><span class="line">print(temp.bit_length()) </span><br><span class="line"></span><br><span class="line">temp2 = gmpy2.iroot(r**2+f**2, 2)[0]  </span><br><span class="line"></span><br><span class="line">print(temp2.bit_length())  </span><br><span class="line"></span><br><span class="line">if temp.bit_length() &gt;= temp2.bit_length():</span><br><span class="line"></span><br><span class="line">  print(&quot;true&quot;)</span><br><span class="line"></span><br><span class="line">else:</span><br><span class="line"></span><br><span class="line">  print(&quot;false&quot;)</span><br><span class="line"></span><br><span class="line"># 513</span><br><span class="line"></span><br><span class="line"># 225</span><br><span class="line"></span><br><span class="line"># true</span><br></pre></td></tr></table></figure>
<p>这里是满足的，那就能直接规约了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">a = <span class="number">79047880584807269054505204752966875903807058486141783766561521134845058071995038638934174701175782152417081883728635655442964823110171015637136681101856684888576194849310180873104729087883030291173114003115983405311162152717385429179852150760696213217464522070759438318396222163013306629318041233934326478247</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">90596199661954314748094754376367411728681431234103196427120607507149461190520498120433570647077910673128371876546100672985278698226714483847201363857703757534255187784953078548908192496602029047268538065300238964884068500561488409356401505220814317044301436585177722826939067622852763442884505234084274439591</span></span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,[[<span class="number">1</span>,a ],[<span class="number">0</span>, p]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(L.LLL())</span><br><span class="line"></span><br><span class="line">f,g = L.LLL()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">f,g = <span class="built_in">abs</span>(f),<span class="built_in">abs</span>(g)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(g)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(g))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;NSSCTF&#123;e572546b-abb5-4358-8970-471abc12b7ef&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="p5">p5</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> m.bit_length() == <span class="number">351</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">b = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">c = getPrime(<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">a = (b*m + c) % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>题目还是给出了一个线性关系式<br>
$$<br>
a = b*m +c+kp<br>
$$</p>
<p>$$<br>
c = a-b*m+kp<br>
$$</p>
<p>造格<br>
$$<br>
\begin{pmatrix}<br>
1&amp;m &amp;k<br>
\end{pmatrix}\begin{bmatrix}<br>
1 &amp; 0 &amp; a\<br>
0 &amp; 1 &amp; -b \<br>
0 &amp; 0 &amp; p<br>
\end{bmatrix}=\begin{pmatrix}<br>
1&amp; m&amp;c<br>
\end{pmatrix}<br>
$$<br>
现在还是要先看是否满足Hermite定理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">b = <span class="number">2</span> ** <span class="number">0</span>  <span class="comment">#这是不断调整配平用的</span></span><br><span class="line"></span><br><span class="line">f = flag = getPrime(<span class="number">351</span>)  </span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">b = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">c = getPrime(<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">det = p </span><br><span class="line"></span><br><span class="line">temp = gmpy2.iroot(n, <span class="number">2</span>)[<span class="number">0</span>] * gmpy2.iroot(det, n)[<span class="number">0</span>]  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp.bit_length()) </span><br><span class="line"></span><br><span class="line">temp2 = gmpy2.iroot(f**<span class="number">2</span>+(c)**<span class="number">2</span>, <span class="number">2</span>)[<span class="number">0</span>]  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp2.bit_length())  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> temp.bit_length() &gt;= temp2.bit_length():</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;true&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;false&quot;</span>)</span><br><span class="line"><span class="comment">#342</span></span><br><span class="line"><span class="comment">#400</span></span><br><span class="line"><span class="comment">#false</span></span><br></pre></td></tr></table></figure>
<p>这里是不满足的Hermite定理的</p>
<p>所以我们需要配平，也就是平衡格基，尽量让基的数量级接近</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">b = <span class="number">2</span> ** <span class="number">0</span>  <span class="comment">#这是不断调整配平用的</span></span><br><span class="line"></span><br><span class="line">f = flag = getPrime(<span class="number">351</span>)  </span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">b = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">c = getPrime(<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">det = p * <span class="number">2</span>**<span class="number">350</span></span><br><span class="line"></span><br><span class="line">temp = gmpy2.iroot(n, <span class="number">2</span>)[<span class="number">0</span>] * gmpy2.iroot(det, n)[<span class="number">0</span>]  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp.bit_length()) </span><br><span class="line"></span><br><span class="line">temp2 = gmpy2.iroot(f**<span class="number">2</span>+(c)**<span class="number">2</span>, <span class="number">2</span>)[<span class="number">0</span>]  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp2.bit_length())  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> temp.bit_length() &gt;= temp2.bit_length():</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;true&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;false&quot;</span>)</span><br><span class="line"><span class="comment">#458</span></span><br><span class="line"><span class="comment">#400</span></span><br><span class="line"><span class="comment">#true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>最后得到<br>
$$<br>
\begin{pmatrix}<br>
1&amp;m &amp;k<br>
\end{pmatrix}\begin{bmatrix}<br>
2^{350} &amp; 0 &amp; a\<br>
0 &amp; 1 &amp; -b \<br>
0 &amp; 0 &amp; p<br>
\end{bmatrix}=\begin{pmatrix}<br>
2^{350}&amp; m&amp;c<br>
\end{pmatrix}<br>
$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">a = </span><br><span class="line"></span><br><span class="line">b = </span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,[[<span class="number">2</span>^<span class="number">350</span>, <span class="number">0</span>, a],</span><br><span class="line"></span><br><span class="line">        [<span class="number">0</span>, <span class="number">1</span>, -b],</span><br><span class="line"></span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, p]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(L.LLL())</span><br><span class="line"></span><br><span class="line">t,m,c = L.LLL()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">t,m,c = <span class="built_in">abs</span>(t),<span class="built_in">abs</span>(m),<span class="built_in">abs</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;NSSCTF&#123;ee5cb1a5-257a-48b0-9d62-9ef56ff0651a&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="p6">p6</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">d = getPrime(<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line"></span><br><span class="line">  p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">  q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">  n = p * q</span><br><span class="line"></span><br><span class="line">  e = inverse(d, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">  c = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;e<span class="subst">&#123;i&#125;</span> =&#x27;</span>, e)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;n<span class="subst">&#123;i&#125;</span> =&#x27;</span>, n)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;c<span class="subst">&#123;i&#125;</span> =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e0 = 14663634286442041092028764808273515750847961898014201055608982250846018719684424125895815390624536073501623753618354026800118456911536861815261996929625814961086913500837475340797921236556312296934664701095834187857404704711288771338418177336783911864595983563560080719582434186801068157426993026446515265411</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n0 = 104543450623548393448505960506840545298706691237630183178416927557780858213264769135818447427794932329909731890957245926915280713988801182894888947956846369966245947852409172099018409057129584780443712258590591272371802134906914886744538889099861890573943377480028655951935894660286388060056770675084677768397</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c0 = 66400441793466385558399002350812383744096354576421495899465166492721568297592616443643465864544107914461044325088868615645524260480104397769130582397209585192620565774001015221725536884170662700337565613181799442382460047295553807602785067421981837709831158111951991854109179278733629950271657405211417740374</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e1 = 62005504700456859456675572895620453845623573672275890584145949847469951381521709553504593023003977393014834639251022203398533914340078480147377747715528821418445514563871411209895815634752533151145061594791024551625615960423026244560340983481137777162236719939420428613005457949228517914830194749293637917667</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n1 = 89410873947410184231222334229470195622685051370058935269198780539059522679122059486414591834635266301335656798768270022060656655274640699951736588085471509424575027153387518893978494158981314217195561629375189515702124478687925014362857206223379284909134299260355456357407022417434961226383007916607728238843</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c1 = 75133250536426006056029454024900058936095761927174304108454764308417889983571094946046507426319589437822458959089546795698076608690695326741772662156830944126301658579142020817338297043884836598263468494533324693019866746045910394812656639124276516075062088756043949581789436307373276242558429450971458945061</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e2 = 5365316217065391632204029784515519544882379449147835081003675696051077792179684123668298103660153980837519314114793091112163153158510344440829742753002176560016265852613076363394396640641504813912550948776926622696268531691467015580417575287779607009068332802842890478748171958455354463809356050553832863427</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n2 = 53325942266099921615667538877103327425435396909592382386684073177331528393295928518724880712900970020425481561110366696624090824641115147978830715508666547064446891727446073538022824237798568413003419382767587742032676311751819789672319289920011033523044026418650515529084031754775286163358926609712626506433</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c2 = 22289960513520782629306709529908652726794465066357062923684089176607114605563538085483920152508469429311012652149406853144200001391310165612163442404181970125704785325670969551080086517236489885046039799676581310781945432599048686184762485374030278657826206433571162451649808912276118945302558580745346371321</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e3 = 57257245945110486431680573908783487217316546039634811903637650579658516537372808464426294780698320301497615457264001148504941375058983426920721566040576604013497311914160175024860226623138659970105781812246471618831032554729317463745699993647224910498474869868186318188994237457335796911524629938029123055027</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n3 = 97233843381238063550322854422952777734101562842513647224354265328843953949189054347560960321126304504554067163501318212533606313039536188796999575130115659250566231010092273206623114900781284076452654791214088764465615154940874231056251107863895697778665275804663487113266180838319536762473697586368100928379</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c3 = 56606672064789484727896188434430896229911224588055894584797861263107870392831242138537980507537270618683458635389444257040355313948352917061971042629958646854593628522401074068536976581232979947149230764268377747754284783531803366391759725774562719884482404532619163798580872386794273190532863916038929461465</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这里是个论文题，需要找到<a target="_blank" rel="noopener" href="https://www.ijcsi.org/papers/IJCSI-9-2-1-311-314.pdf">paper</a></p>
<p>文中指出了格应该如何构造</p>
<p><img src="/img/test_photo/cbb82dda8febc80e5704a91fa3e15bd1.png" alt=""></p>
<p>这里给出了我们的格也就是<br>
$$<br>
(d, k_1, k_2, \cdots, k_r)</p>
<p>\begin{bmatrix}<br>
M &amp; e_1 &amp; e_2 &amp; \cdots &amp; e_r \<br>
0 &amp; -N_1 &amp; 0 &amp; \cdots &amp; 0 \<br>
0 &amp; 0 &amp; -N_2 &amp; \cdots &amp; 0 \<br>
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \<br>
0 &amp; 0 &amp; 0 &amp; \cdots &amp; -N_r<br>
\end{bmatrix}=<br>
(dM, 1 - k_1 s_1, \cdots, 1 - k_r s_r)<br>
$$<br>
这里的M满足条件$M=\sqrt{N_{max}}$</p>
<p>现在就可以根据现有的条件来求出私钥d了</p>
<p>在论文中已经给出了证明是最短向量，所以也就不需要看是否满足了Hermite定理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e0 = </span><br><span class="line"></span><br><span class="line">n0 = </span><br><span class="line"></span><br><span class="line">c0 = </span><br><span class="line"></span><br><span class="line">e1 = </span><br><span class="line"></span><br><span class="line">n1 = </span><br><span class="line"></span><br><span class="line">c1 = </span><br><span class="line"></span><br><span class="line">e2 = </span><br><span class="line"></span><br><span class="line">n2 = </span><br><span class="line"></span><br><span class="line">c2 = </span><br><span class="line"></span><br><span class="line">e3 = </span><br><span class="line"></span><br><span class="line">n3 = </span><br><span class="line"></span><br><span class="line">c3 = </span><br><span class="line"></span><br><span class="line">n = [n0,n1,n2]</span><br><span class="line"></span><br><span class="line">M = isqrt(<span class="built_in">max</span>(n))</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,[[M, e0, e1, e2, e3],</span><br><span class="line"></span><br><span class="line">        [<span class="number">0</span>, -n0 ,<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span> ],</span><br><span class="line"></span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, -n1, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"></span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span> ,-n2, <span class="number">0</span>],</span><br><span class="line"></span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span> ,<span class="number">0</span>,-n3]</span><br><span class="line"></span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">d_M = L.LLL()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">d = d_M //M</span><br><span class="line"></span><br><span class="line">m = power_mod(c0, d, n0)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;NSSCTF&#123;12514adb-2c14-4777-96ff-90e95bc2b5cb&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="p7">p7</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(flag, <span class="number">65537</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n =&#x27;</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line"></span><br><span class="line">  d = getPrime(<span class="number">350</span>)</span><br><span class="line"></span><br><span class="line">  e = inverse(d, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;e<span class="subst">&#123;i&#125;</span> =&#x27;</span>, e)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n = </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c = </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e0 = </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e1 = </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这里同样是个论文题，<a target="_blank" rel="noopener" href="https://dunkirkturbo.github.io/2020/05/04/WriteUp-De1CTF2020-Crypto/howgrave-graham1999.pdf">paper</a>是这个，也就是讲了关于拓展维纳攻击</p>
<p>这里具体的推导就不详细赘述了，<a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/d_attacks/rsa_extending_wiener/#_3">CTFWiki</a>中有对论文的说明</p>
<p>根据论文中所述我们可以构造出矩阵<br>
$$<br>
D =<br>
\begin{pmatrix}<br>
N &amp; &amp; &amp; \<br>
&amp; N^{1/2} &amp; &amp; \<br>
&amp; &amp; N^{1 + \alpha_2} &amp; \<br>
&amp; &amp; &amp; 1<br>
\end{pmatrix}<br>
$$<br>
最后得到<br>
$$<br>
L = \begin{pmatrix}<br>
1 &amp; -N &amp; 0 &amp; N^2 \<br>
&amp; e_1 &amp; -e_1 &amp; -e_1N \<br>
&amp; &amp; e_2 &amp; -e_2N \<br>
&amp; &amp; &amp; e_1e_2<br>
\end{pmatrix} \times D<br>
$$<br>
最后$φ(N)=\frac{edg}{k} -\frac{g}{k}$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e0 = </span><br><span class="line">e1 = </span><br><span class="line">a = <span class="number">5</span>/<span class="number">14</span></span><br><span class="line">D = diagonal_matrix(ZZ, [n, <span class="built_in">int</span>(n^(<span class="number">1</span>/<span class="number">2</span>)), <span class="built_in">int</span>(n^(<span class="number">1</span>+a)), <span class="number">1</span>])</span><br><span class="line">M = Matrix(ZZ, [[<span class="number">1</span>, -n, <span class="number">0</span>, n^<span class="number">2</span>],</span><br><span class="line">                [<span class="number">0</span>, e0, -e0, -e0*n],</span><br><span class="line">                [<span class="number">0</span>,  <span class="number">0</span>, e1,  -e1*n],</span><br><span class="line">                [<span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>,  e0*e1]])*D</span><br><span class="line">L = M.LLL()</span><br><span class="line">t = vector(ZZ, L[<span class="number">0</span>])</span><br><span class="line">x = t * M^(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">x * M = t</span><br><span class="line">phi = <span class="built_in">int</span>(x[<span class="number">1</span>]/x[<span class="number">0</span>]*e0)</span><br><span class="line"></span><br><span class="line">d = inverse_mod(<span class="number">65537</span>, phi)</span><br><span class="line">m = power_mod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>关于三个指数攻击的题目在HGAME 2023中也是有道题目的</p>
<h5 id="p8">p8</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">s = [getPrime(<span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">a = [getPrime(<span class="number">512</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">c = (a[<span class="number">0</span>]*s[<span class="number">0</span>]**<span class="number">2</span>*s[<span class="number">1</span>]**<span class="number">2</span> + a[<span class="number">1</span>]*s[<span class="number">0</span>]*s[<span class="number">2</span>]**<span class="number">2</span> + a[<span class="number">2</span>]*s[<span class="number">1</span>]*s[<span class="number">2</span>]) % p</span><br><span class="line"></span><br><span class="line">flag = m*s[<span class="number">0</span>]*s[<span class="number">1</span>]*s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;flag = <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c = 740925064346371394698186587854547113606276228956443989781507592148712696471120454242180757282913190509143771235457885619359315384722931529795071829165028</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">flag = 68803130911709451943985629442913968356735244797651554293510331427148284907075221530061581131130283569506280604032687824733336171953927</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a = [8205051800134728054685810600921116779466017139080528864745521629232854690213051609775306424843961090482436503418278207286549634492623172279113808752825877, 7656695314164580223033364292542508972053206838456547579023164583502640699225283686572923544677077467571265812610524520719197913305928971777756847148151453, 12016313094941119621096276870216129960285946825332008187797823075795491053640261786033376211694851951499688886358239835607622191418940486434225440651886891]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">p = 9725369974716521164256395525866212215114818770667579116304398350357785690930260317036889742178436308598088096925530431498664796728861093872628194022265573</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这道题目也不难看懂，最主要是求出s[0]，s[1]，s[2]</p>
<p>同时题目中也是给出了它们的线性表达式<br>
$$<br>
c = a_0<em>s_0^{2}<em>s_1^{2}+a_1</em>s_0</em>s_2^{2}+a_2<em>s_1</em>s_2+kp<br>
$$<br>
这里还是先将未知量放到等式的一侧</p>
<p>将两边同时乘上$a_2^{-1}$,那么就有<br>
$$<br>
s_1<em>s_2=a_0</em>a_2^{-1}<em>s_0^{2}<em>s_1^{2}+a_1</em>a_2^{-1}<em>s_0</em>s_2^{2}-c</em>a_2^{-1}+kp<br>
$$<br>
那么可以构造格<br>
$$<br>
\begin{bmatrix}<br>
1 &amp; 0 &amp; 0 &amp;a_0<em>a_2^{-1} \<br>
0&amp; 1 &amp; 0 &amp; a_1</em>a_2^{-1}\<br>
0&amp; 0 &amp; 1 &amp;-c<em>a_2^{-1} \<br>
0&amp; 0 &amp; 0 &amp;p<br>
\end{bmatrix}<br>
$$<br>
那么就有<br>
$$<br>
\begin{pmatrix}<br>
s_0^{2}<em>s_1^{2}&amp;s_0</em>s_2^{2} &amp;1 &amp;k &amp;<br>
\end{pmatrix}\begin{bmatrix}<br>
1 &amp; 0 &amp; 0 &amp;a_0</em>a_2^{-1} \<br>
0&amp; 1 &amp; 0 &amp; a_1<em>a_2^{-1}\<br>
0&amp; 0 &amp; 1 &amp;-c</em>a_2^{-1} \<br>
0&amp; 0 &amp; 0 &amp;p<br>
\end{bmatrix}=<br>
\begin{pmatrix}<br>
s_0^{2}<em>s_1^{2}&amp;s_0</em>s_2^{2} &amp;1 &amp;s_1*s_2 &amp;<br>
\end{pmatrix}<br>
$$<br>
那么下面还要看是否满足Hermite定理,这里不放测试的数据了，因为后面的基明显需要配$2^{128}$来平衡格基</p>
<p>所以最后的格应该是<br>
$$<br>
\begin{pmatrix}<br>
s_0^{2}<em>s_1^{2}&amp;s_0</em>s_2^{2} &amp;1 &amp;k &amp;<br>
\end{pmatrix}\begin{bmatrix}<br>
1 &amp; 0 &amp; 0 &amp;a_0<em>a_2^{-1} \<br>
0&amp; 2^{32} &amp; 0 &amp; a_1</em>a_2^{-1}\<br>
0&amp; 0 &amp; 2^{128} &amp;-c<em>a_2^{-1} \<br>
0&amp; 0 &amp; 0 &amp;p</em>2^{64}<br>
\end{bmatrix}=<br>
\begin{pmatrix}<br>
s_0^{2}<em>s_1^{2}&amp;s_0</em>s_2^{2} &amp;1 &amp;s_1*s_2 &amp;<br>
\end{pmatrix}<br>
$$<br>
也就是乘上一个对角线矩阵<br>
$$<br>
\begin{bmatrix}<br>
1 &amp;  &amp;  &amp; \<br>
&amp; 2^{32} &amp;  &amp; \<br>
&amp;  &amp; 2^{128} &amp; \<br>
&amp;  &amp;  &amp;2^{64}<br>
\end{bmatrix}<br>
$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">740925064346371394698186587854547113606276228956443989781507592148712696471120454242180757282913190509143771235457885619359315384722931529795071829165028</span></span><br><span class="line">flag = <span class="number">68803130911709451943985629442913968356735244797651554293510331427148284907075221530061581131130283569506280604032687824733336171953927</span></span><br><span class="line">a = [<span class="number">8205051800134728054685810600921116779466017139080528864745521629232854690213051609775306424843961090482436503418278207286549634492623172279113808752825877</span>, <span class="number">7656695314164580223033364292542508972053206838456547579023164583502640699225283686572923544677077467571265812610524520719197913305928971777756847148151453</span>, <span class="number">12016313094941119621096276870216129960285946825332008187797823075795491053640261786033376211694851951499688886358239835607622191418940486434225440651886891</span>]</span><br><span class="line">p = <span class="number">9725369974716521164256395525866212215114818770667579116304398350357785690930260317036889742178436308598088096925530431498664796728861093872628194022265573</span></span><br><span class="line"></span><br><span class="line">ia = inverse_mod(a[<span class="number">2</span>], p)</span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ, [[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, a[<span class="number">0</span>]*ia%p],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, a[<span class="number">1</span>]*ia%p],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,   -c*ia%p],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,         p]]) * diagonal_matrix(ZZ, [<span class="number">1</span>, <span class="number">2</span>^<span class="number">32</span>, <span class="number">2</span>^<span class="number">128</span>, <span class="number">2</span>^<span class="number">64</span>])</span><br><span class="line"></span><br><span class="line">v = L.LLL()[<span class="number">0</span>]</span><br><span class="line">s0s1 = isqrt(<span class="built_in">abs</span>(v[<span class="number">0</span>]))</span><br><span class="line">s1s2 = <span class="built_in">abs</span>(v[<span class="number">3</span>]) &gt;&gt; <span class="number">64</span>   <span class="comment">#因为在对角矩阵中乘上了2^64要把这个除掉，其实在对角矩阵中不乘2^64也是可以的</span></span><br><span class="line">s1 = gcd(s0s1, s1s2) <span class="comment">#都有因子s1,所以取个GCD即可</span></span><br><span class="line">s0 = s0s1 // s1</span><br><span class="line">s2 = s1s2 // s1</span><br><span class="line"></span><br><span class="line">flag = flag // s0 // s1 // s2</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;NSSCTF&#123;30636075-1942-49e7-acf2-721e3b587188&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">yskm</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/09/21/%E6%A0%BC%E5%AF%86%E7%A0%81/">http://example.com/2025/09/21/%E6%A0%BC%E5%AF%86%E7%A0%81/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">yskm</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/09/16/Gr%C3%B6bner%E5%9F%BA%E5%AD%A6%E4%B9%A0/" title="Gröbner基学习"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Gröbner基学习</div></div><div class="info-2"><div class="info-item-1">Gröbner基学习 我是跟着这篇博客学习的 把Gröbner基当作一个求解同余方程组的工具 一般可以用 Ideal.groebner_basis() 来解方程组 先来看具体的实例 12345678910111213from Crypto.Util.number import *p, q = getPrime(256), getPrime(256)N = p * qm1 = bytes_to_long(b&quot;flag&#123;12345678901234567890&quot;)m2 = bytes_to_long(b&quot;1234567890123456789012345&quot;)m3 = bytes_to_long(b&quot;6789012345678901234567890&#125;&quot;)e = 17c1 = pow(m1, e, N)c2 = pow(m2, e, N)c3 = pow(m3, e, N)s = m1 + m2 + m3print(c1, c2, c3,...</div></div></div></a><a class="pagination-related" href="/2025/10/09/ECC/" title="ECC"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">ECC</div></div><div class="info-2"><div class="info-item-1">ECC 椭圆曲线是什么 满足 Weierstrass 方程的点集,形如： $$ Y^2=X^3+AX+B $$ 这样的等式称为椭圆曲线(elliptic curve)  当这个方程表示的曲线是一条连续的曲线时,需要满足条件 $$ 4A^{3}+27B^{2}≠ 0 $$ 这时称为非奇异椭圆曲线，反之称为奇异椭圆曲线 奇异椭圆曲线都是形状有点尖或者有交叉   这些情况下的点加法会出现问题 下面来介绍一下点加法 我们在椭圆曲线上定义加的运算，我在曲线上找到两点P，Q,现在想要计算出$P \oplus Q$ 首先我们连接P,Q两点，与椭圆曲线E相交于一点 相交的点关x的对称的点就是$P \oplus Q$的点R  这里我考虑一个情况如果当P=Q的时候也就是$P \oplus P$，该如何运算呢 其实还是一样的，只不过这次我们取过椭圆曲线E上的点P的切线，再与曲线相交后做关于x轴的对称点即可  现在还有种情况就是如果是无穷远点呢，也就是当P,Q关于x轴对称  也就是$P \oplus P’ = \mathcal{O}$ 这时候会发现 $$ P \oplus \mathcal{O} =...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">yskm</div><div class="author-info-description">I decide which body my bullets enter</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎各位师傅批评指正</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">格密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%91%E9%87%8F"><span class="toc-number">1.0.1.</span> <span class="toc-text">向量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%91%E9%87%8F%E7%9A%84%E8%BF%90%E7%AE%97"><span class="toc-number">1.0.1.1.</span> <span class="toc-text">向量的运算</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4"><span class="toc-number">1.0.2.</span> <span class="toc-text">向量空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%91%E9%87%8F%E6%AD%A3%E4%BA%A4%E4%B8%8E%E6%96%BD%E5%AF%86%E7%89%B9-Schmidt-%E6%AD%A3%E4%BA%A4%E5%8C%96"><span class="toc-number">1.0.3.</span> <span class="toc-text">向量正交与施密特(Schmidt)正交化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC"><span class="toc-number">1.0.4.</span> <span class="toc-text">格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hermite%E5%AE%9A%E7%90%86"><span class="toc-number">1.0.5.</span> <span class="toc-text">Hermite定理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%9F%BA%E8%A7%84%E7%BA%A6"><span class="toc-number">1.0.5.1.</span> <span class="toc-text">格基规约</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%AF%86%E7%A0%81%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">1.0.6.</span> <span class="toc-text">格密码的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-NTRU"><span class="toc-number">1.0.6.1.</span> <span class="toc-text">1.NTRU</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#easyLattice"><span class="toc-number">1.0.6.1.1.</span> <span class="toc-text">easyLattice</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81"><span class="toc-number">1.0.6.2.</span> <span class="toc-text">2.背包密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-number">1.0.6.3.</span> <span class="toc-text">题目</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#p3"><span class="toc-number">1.0.6.3.1.</span> <span class="toc-text">p3</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#P4"><span class="toc-number">1.0.6.3.2.</span> <span class="toc-text">P4</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#p5"><span class="toc-number">1.0.6.3.3.</span> <span class="toc-text">p5</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#p6"><span class="toc-number">1.0.6.3.4.</span> <span class="toc-text">p6</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#p7"><span class="toc-number">1.0.6.3.5.</span> <span class="toc-text">p7</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#p8"><span class="toc-number">1.0.6.3.6.</span> <span class="toc-text">p8</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/09/ECC/" title="ECC">ECC</a><time datetime="2025-10-09T05:12:38.728Z" title="发表于 2025-10-09 13:12:38">2025-10-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/21/%E6%A0%BC%E5%AF%86%E7%A0%81/" title="格密码">格密码</a><time datetime="2025-09-21T06:59:21.980Z" title="发表于 2025-09-21 14:59:21">2025-09-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/16/Gr%C3%B6bner%E5%9F%BA%E5%AD%A6%E4%B9%A0/" title="Gröbner基学习">Gröbner基学习</a><time datetime="2025-09-16T11:19:14.495Z" title="发表于 2025-09-16 19:19:14">2025-09-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/15/Shamir's%20secret%20sharing/" title="Shamir's secret sharing">Shamir's secret sharing</a><time datetime="2025-09-15T05:23:35.198Z" title="发表于 2025-09-15 13:23:35">2025-09-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/02/h4ckcon/" title="h4ck0n CTF 2025">h4ck0n CTF 2025</a><time datetime="2025-09-02T05:08:20.544Z" title="发表于 2025-09-02 13:08:20">2025-09-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By yskm</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><canvas id="snow"></canvas><script async src="/js/snow.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>